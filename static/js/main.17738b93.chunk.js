(this.webpackJsonpywitter=this.webpackJsonpywitter||[]).push([[0],{62:function(e,t,n){"use strict";n.r(t);var r=n(10),c=n.n(r),a=n(40),i=n.n(a),u=n(11),s=n(31),o=n(13),j=n(0),b=n.n(j),l=n(1),d=n(41),O=n(45),h=n(42),f=n(46);d.a({apiKey:"AIzaSyCmCUS5rX_S8NLXniIJ9YbVJ6hS6OVD2BQ",authDomain:"ywitter-1f9bb.firebaseapp.com",projectId:"ywitter-1f9bb",storageBucket:"ywitter-1f9bb.appspot.com",messagingSenderId:"800576019370",appId:"1:800576019370:web:8e743a91a75bc6a69ba9d3"});var p=O,x=h,g=f,m=n(6),v=function(){var e=Object(r.useState)(""),t=Object(u.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),i=Object(u.a)(a,2),s=i[0],o=i[1],j=Object(r.useState)(!0),d=Object(u.a)(j,2),O=d[0],h=d[1],f=Object(r.useState)(""),x=Object(u.a)(f,2),g=x[0],v=x[1],w=function(e){var t=e.target,n=t.name,r=t.value;"email"===n&&c(r),"password"===n&&o(r)},y=function(){var e=Object(l.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!O){e.next=6;break}return e.next=4,p.createUserWithEmailAndPassword(p.getAuth(),n,s).catch((function(e){v(e.message)}));case 4:e.next=8;break;case 6:return e.next=8,p.signInWithEmailAndPassword(p.getAuth(),n,s).catch((function(e){v(e.message)}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(l.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"google"===(n=t.target.name)?r=new p.GoogleAuthProvider:"github"===n&&(r=new p.GithubAuthProvider),e.next=4,p.signInWithPopup(p.getAuth(),r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsxs)("div",{children:[Object(m.jsxs)("form",{onSubmit:y,children:[Object(m.jsx)("input",{name:"email",type:"email",placeholder:"email",required:!0,value:n,onChange:w}),Object(m.jsx)("input",{name:"password",type:"password",placeholder:"password",required:!0,value:s,onChange:w}),Object(m.jsx)("input",{type:"submit",value:O?"Create Account":"Sign in",required:!0}),g]}),Object(m.jsx)("span",{onClick:function(){h((function(e){return!e})),v("")},children:O?"Sign in":"Create Account"}),Object(m.jsxs)("div",{children:[Object(m.jsx)("button",{onClick:S,name:"google",children:"continue with Google"}),Object(m.jsx)("button",{onClick:S,name:"github",children:"continue with Github"})]})]})},w=n(34),y=n(64),S=function(e){var t=e.userObj,n=Object(r.useState)(""),c=Object(u.a)(n,2),a=c[0],i=c[1],s=Object(r.useState)(null),o=Object(u.a)(s,2),j=o[0],d=o[1],O=Object(r.useRef)(null),h=function(){var e=Object(l.a)(b.a.mark((function e(n){var r,c,u,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),r="",null===j){e.next=10;break}return c=g.ref(g.getStorage(),"".concat(t.uid,"/").concat(Object(y.a)())),e.next=6,g.uploadString(c,j,"data_url");case 6:return u=e.sent,e.next=9,g.getDownloadURL(u.ref);case 9:r=e.sent;case 10:s={text:a,createdAt:Date.now(),creatorId:t.uid,attachmentUrl:r},x.addDoc(x.collection(x.getFirestore(),"yweet"),s),i(""),p();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(e){if(e){var t=e.target.files[0],n=new FileReader;n.onloadend=function(e){var t=e.target.result;d(t)},n.readAsDataURL(t)}else console.log(O.current.value="")},p=function(){d(null),f(null)};return Object(m.jsxs)("form",{onSubmit:h,children:[Object(m.jsx)("input",{value:a,onChange:function(e){var t=e.target.value;i(t)},type:"text",placeholder:"What's on your mind?",maxLength:120}),Object(m.jsx)("input",{type:"submit",value:"Yweet"}),Object(m.jsx)("input",{ref:O,type:"file",accept:"image/*",onChange:f}),j&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("img",{src:j,width:"50px",height:"50px",alt:""}),Object(m.jsx)("button",{onClick:p,children:"clear attachment"})]})]})},k=function(e){var t=e.yweetObj,n=e.isOwner,c=Object(r.useState)(!1),a=Object(u.a)(c,2),i=a[0],s=a[1],o=Object(r.useState)(t.text),j=Object(u.a)(o,2),d=j[0],O=j[1],h=function(){var e=Object(l.a)(b.a.mark((function e(){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("are you sure?")){e.next=8;break}return x.deleteDoc(x.doc(x.getFirestore(),"yweet",t.id)),n=g.ref(g.getStorage(),t.attachmentUrl),e.next=6,g.deleteObject(n);case 6:r=e.sent,console.log(r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){return s((function(e){return!e}))};return Object(m.jsx)("div",{children:i?n&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("form",{onSubmit:function(e){e.preventDefault(),x.updateDoc(x.doc(x.getFirestore(),"yweet",t.id),{text:d}),f()},children:[Object(m.jsx)("input",{onChange:function(e){var t=e.target.value;O(t)},type:"text",value:d,required:!0}),Object(m.jsx)("input",{type:"submit",value:"edit",onClick:function(){}})]}),Object(m.jsx)("button",{onClick:f,children:"Cancel"})]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("h4",{children:t.text}),t.attachmentUrl&&Object(m.jsx)("img",{src:t.attachmentUrl,width:"50px",height:"50px",alt:""}),n?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("button",{onClick:h,children:"Delete"}),Object(m.jsx)("button",{onClick:f,children:"Edit"})]}):""]})})},C=function(e){var t=e.yweets,n=e.userObj;return Object(m.jsx)("div",{children:t.map((function(e){return Object(m.jsx)(k,{yweetObj:e,isOwner:e.creatorId===n.uid},e.id)}))})},A=function(e){var t=e.userObj,n=Object(r.useState)([]),c=Object(u.a)(n,2),a=c[0],i=c[1];return Object(r.useEffect)((function(){var e=x.collection(x.getFirestore(),"yweet"),t=x.query(e,x.orderBy("createdAt","desc"));x.onSnapshot(e,x.getDocs(t).then((function(e){var t=e.docs.map((function(e){return Object(w.a)({id:e.id},e.data())}));i(t)})))})),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(S,{userObj:t}),Object(m.jsx)(C,{yweets:a,userObj:t})]})},D=function(e){var t=e.userObj,n=e.refreshUser,c=Object(o.f)(),a=Object(r.useState)([]),i=Object(u.a)(a,2),s=i[0],j=i[1],d=Object(r.useState)(t.displayName),O=Object(u.a)(d,2),h=O[0],f=O[1],g=function(){var e=Object(l.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.getAuth().signOut();case 2:c.push("/");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){!function(){var e=x.collection(x.getFirestore(),"yweet"),n=x.query(e,x.where("creatorId","==",t.uid),x.orderBy("createdAt"));x.getDocs(n).then((function(e){var t=e.docs.map((function(e){return Object(w.a)({id:e.id},e.data())}));j(t)}))}()})),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("form",{onSubmit:function(e){e.preventDefault(),p.updateProfile(t,{displayName:e.target.inputDisplayName.value}).then((function(e){n()}))},children:[Object(m.jsx)("input",{name:"inputDisplayName",type:"text",onChange:function(e){var t=e.target.value;f(t)},value:h}),Object(m.jsx)("input",{type:"submit",value:"change"})]}),Object(m.jsx)("button",{onClick:g,children:"Log out"}),Object(m.jsx)(C,{yweets:s,userObj:t})]})},F=function(e){var t=e.userObj;return Object(m.jsx)("nav",{children:Object(m.jsxs)("ul",{children:[Object(m.jsx)("li",{children:Object(m.jsx)(s.b,{to:"/",children:"Home"})}),Object(m.jsx)("li",{children:Object(m.jsxs)(s.b,{to:"/profile",children:[t.displayName,"'s Profile"]})})]})})},I=function(e){var t=e.isLoggedIn,n=e.userObj,c=e.refreshUser;return Object(m.jsxs)(s.a,{children:[t&&Object(m.jsx)(F,{userObj:n}),Object(m.jsx)(o.c,{children:t?Object(m.jsxs)(r.Fragment,{children:[Object(m.jsx)(o.a,{exact:!0,path:"/",children:Object(m.jsx)(A,{userObj:n})}),Object(m.jsx)(o.a,{exact:!0,path:"/profile",children:Object(m.jsx)(D,{refreshUser:c,userObj:n})})]}):Object(m.jsx)(o.a,{exact:!0,path:"/",children:Object(m.jsx)(v,{})})})]})},U=function(){var e=Object(r.useState)(!1),t=Object(u.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(null),i=Object(u.a)(a,2),s=i[0],o=i[1];Object(r.useEffect)((function(){p.onAuthStateChanged(p.getAuth(),(function(e){o(e||null),c(!0)}))}),[]);return Object(m.jsx)(m.Fragment,{children:n?Object(m.jsx)(I,{refreshUser:function(){var e=p.getAuth().currentUser;o(Object.assign({},e)),o(e)},isLoggedIn:Boolean(s),userObj:s}):"initializing"})};i.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(U,{})}),document.getElementById("root"))}},[[62,1,2]]]);
//# sourceMappingURL=main.17738b93.chunk.js.map